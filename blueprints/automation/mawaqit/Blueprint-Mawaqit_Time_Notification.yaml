blueprint:
  name: Mawaqit Time Notification
  description:
    Notification at the time of the mawaqit prayers. PLEASE make sure to
    install 'Mawaqit Prayer Times' integration before you use this blueprint.
  domain: automation
  input:
    Mobile_to_Notify:
      name: Mobile 1 Device to notify
      description:
        Device needs to run the official Home Assistant app to receive
        notifications.
      default: ""
      selector:
        device:
          integration: mobile_app
    Mobile2_to_Notify:
      name: Mobile 2 Device to notify
      description:
        Device needs to run the official Home Assistant app to receive
        notifications.
      default: ""
      selector:
        device:
          integration: mobile_app

    Media_Player_to_Notify:
      name: Media Player to play Athan
      description: Choose Media player device to play the Athan.
      selector:
        entity:
          domain: media_player
    Athan_Media:
      name: Athan Media
      description: Name of the playlist that contains the Athan sound or mp3 link if using service music
    Athan_Media_Fajr:
      name: Athan Media Fajr
      description: Name of the playlist that contains the Fajr Athan sound or mp3 link if using service music
    Music_Service:
      name: Music Service
      description: Name of the music service you are subscribed to.
      selector:
        select:
          options:
            - music
            - APPLE_MUSIC
            - AMAZON_MUSIC
            - SPOTIFY
  source_url: https://gist.github.com/shadynafie/1bc4e28717fe0955a828e8d092f7e4bf

trigger:
  - platform: time
    at: sensor.next_salat_time
    id: salat
  - platform: time
    id: prep
    at: sensor.next_salat_preparation_time

condition: []
action:
  - choose:
      - conditions:
          - condition: trigger
            id: prep
        sequence:
          - service: input_number.set_value
            target:
              entity_id: input_number.chapitre_index
            data:
              value: "{{ range(100,114) | random | int }}"

      - conditions:
          - condition: trigger
            id: salat
          - condition: state
            entity_id: "sensor.next_salat_name"
            state: "Shurouq"
        sequence:
          - type: notify
            domain: mobile_app
            device_id: !input "Mobile_to_Notify"
            title: ğŸ•Œ Prayer Time ğŸ•Œ
            message: Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ Ø´Ø±ÙˆÙ‚ Ø§Ù„Ø´Ù…Ø³
          - type: notify
            domain: mobile_app
            device_id: !input "Mobile2_to_Notify"
            title: ğŸ•Œ Prayer Time ğŸ•Œ
            message: Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ Ø´Ø±ÙˆÙ‚ Ø§Ù„Ø´Ù…Ø³
      - conditions:
          - condition: trigger
            id: salat
          - condition: state
            entity_id: "sensor.next_salat_name"
            state: "Fajr"
        sequence:
          - type: notify
            domain: mobile_app
            device_id: !input "Mobile_to_Notify"
            title: ğŸ•Œ Prayer Time ğŸ•Œ
            message: Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø±
          - type: notify
            domain: mobile_app
            device_id: !input "Mobile2_to_Notify"
            title: ğŸ•Œ Prayer Time ğŸ•Œ
            message: Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„ÙØ¬Ø±
          - service: media_player.play_media
            target:
              entity_id: !input "Media_Player_to_Notify"
            data:
              media_content_id: !input "Athan_Media_Fajr"
              media_content_type: !input "Music_Service"

      - conditions:
          - condition: trigger
            id: salat
          - condition: state
            entity_id: "sensor.next_salat_name"
            state: "Dhuhr"
        sequence:
          - type: notify
            domain: mobile_app
            device_id: !input "Mobile_to_Notify"
            title: ğŸ•Œ Prayer Time ğŸ•Œ
            message: Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¸Ù‡Ø±
          - type: notify
            domain: mobile_app
            device_id: !input "Mobile2_to_Notify"
            title: ğŸ•Œ Prayer Time ğŸ•Œ
            message: Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¸Ù‡Ø±
          - service: media_player.play_media
            target:
              entity_id: !input "Media_Player_to_Notify"
            data:
              media_content_id: !input "Athan_Media"
              media_content_type: !input "Music_Service"

      - conditions:
          - condition: trigger
            id: salat
          - condition: state
            entity_id: "sensor.next_salat_name"
            state: "Asr"
        sequence:
          - type: notify
            domain: mobile_app
            device_id: !input "Mobile_to_Notify"
            title: ğŸ•Œ Prayer Time ğŸ•Œ
            message: Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±
          - type: notify
            domain: mobile_app
            device_id: !input "Mobile2_to_Notify"
            title: ğŸ•Œ Prayer Time ğŸ•Œ
            message: Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹ØµØ±
          - service: media_player.play_media
            target:
              entity_id: !input "Media_Player_to_Notify"
            data:
              media_content_id: !input "Athan_Media"
              media_content_type: !input "Music_Service"

      - conditions:
          - condition: trigger
            id: salat
          - condition: state
            entity_id: "sensor.next_salat_name"
            state: "Maghrib"
        sequence:
          - type: notify
            domain: mobile_app
            device_id: !input "Mobile_to_Notify"
            title: ğŸ•Œ Prayer Time ğŸ•Œ
            message: Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨
          - type: notify
            domain: mobile_app
            device_id: !input "Mobile2_to_Notify"
            title: ğŸ•Œ Prayer Time ğŸ•Œ
            message: Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ù…ØºØ±Ø¨
          - service: media_player.play_media
            target:
              entity_id: !input "Media_Player_to_Notify"
            data:
              media_content_id: !input "Athan_Media"
              media_content_type: !input "Music_Service"
      - conditions:
          - condition: trigger
            id: salat
          - condition: state
            entity_id: "sensor.next_salat_name"
            state: "Isha"
        sequence:
          - type: notify
            domain: mobile_app
            device_id: !input "Mobile_to_Notify"
            title: ğŸ•Œ Prayer Time ğŸ•Œ
            message: Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡
          - type: notify
            domain: mobile_app
            device_id: !input "Mobile2_to_Notify"
            title: ğŸ•Œ Prayer Time ğŸ•Œ
            message: Ø­Ø§Ù† Ø§Ù„Ø¢Ù† Ù…ÙˆØ¹Ø¯ ØµÙ„Ø§Ø© Ø§Ù„Ø¹Ø´Ø§Ø¡
          - service: media_player.play_media
            target:
              entity_id: !input "Media_Player_to_Notify"
            data:
              media_content_id: !input "Athan_Media"
              media_content_type: !input "Music_Service"

    default: []
mode: single
